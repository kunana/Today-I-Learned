<!-- START doctoc generated TOC please keep comment here to allow auto update -->
<!-- DON'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE -->


- [TIL   / 2018 - 10 - 27](#til----2018---10---27)
  - [Unity - Tips](#unity---tips)
    - [Spine Animation](#spine-animation)
      - [스파인 에셋을 유니티에 어떻게 사용 하는지?](#%EC%8A%A4%ED%8C%8C%EC%9D%B8-%EC%97%90%EC%85%8B%EC%9D%84-%EC%9C%A0%EB%8B%88%ED%8B%B0%EC%97%90-%EC%96%B4%EB%96%BB%EA%B2%8C-%EC%82%AC%EC%9A%A9-%ED%95%98%EB%8A%94%EC%A7%80)
      - [스파인 애니메이션의 구성](#%EC%8A%A4%ED%8C%8C%EC%9D%B8-%EC%95%A0%EB%8B%88%EB%A9%94%EC%9D%B4%EC%85%98%EC%9D%98-%EA%B5%AC%EC%84%B1)

<!-- END doctoc generated TOC please keep comment here to allow auto update -->

# TIL   / 2018 - 10 - 27
  ## Unity - Tips

> #### 모바일 이미지, 사운드의 용량과 퀄리티간의 밸런스를 잡을때
+ 각 플랫폼 별 압축방식 
    + 안드로이드 - High Quality . 압축 후 실제 품질 확인할것.
    + 모바일은 메모리가 제한적이기 때문에, 사이즈, 압축방법 설정해둘것
    + 텍스쳐에 나오는 용량 표시는 버퍼 사이즈임.

  + IOS 
  + PVRTC 방식 - 로우 엔드 디바이스용 
  + ASTC 방식  - 하이 
  
  + 효과음은 wav. __재생빈도가 잦은 효과음__
  + 배경은은 ogg, mp3 - 압축이 많아서 용량이 작지만, 압축해제 시간이 걸림, __파일이 크고 재생빈도가 낮은 사운드.__
  + 최적화를 위해 용량을 줄였을때, 실제 품질에 차이가 없으면, 로딩시간에 영향이 없으면 할수 있는 만큼 최대로 하자.

> ### 코딩관련

+ 클래스와 구조체를 언제 사용하지는지, 팁
  기준은 개인, 회사, 성향마다 다르지만, 언제 사용하지는 만 알면됨.
  구조체를 이해하려면, 대략적으로 메모리와, 상속을 이해해야됨.

+ 상속을 하려면 클래스
  
+ 상속을 안할경우
``Class는 __힙__영역에, Structure는 __스택__ 영역에 메모리가 잡힘.``

+ 스택에 잡히는 경우에는 GC 가 안잡힘.
  구조체가 작을때는 스택에 잡히지만 구조체 안에 변수의 크기가 커져서 16byte 가 넘으면 힙에 생김. 즉 구조체의 장점을 잊어버림
  
  게임 개발시 확장성을 고려한다면 가급적 구조체를 안쓰는게 좋을 수도 있다.

> ### 유용한 에셋
 텍스쳐를 하나로 합치는 에셋 이나, 퍼포먼스 체크 에셋 (프레임,메모리,등 체크) 

> ### 변수 초기화시  Awake, OnEnable, Start.
개발이 꽤 진행 되었을때, 스크립트 호출순서가 의도하지 않은대로 될때가 있다. 
그럴때, 유니티에 Script Execution Order 에서 설정해 줄것.

다만, 초반 게임 설계시 구조를 완벽하게 알고 있을때만 건드릴것.

Start, Awake 에서는 변수 초기화 할때 많이 사용.
다른 스크립트와 연계되지 않는 독립적인 것들만 넣어주는게 좋음.

매니저 스크립트를 만들어서, 매니저에서 스크립트 ABC를 다 연결해주고, 매니저 스크립트에서 A,B,C 스크립트를 원하는 순서에 따라 AWake, Start를 따로따로 불러준다.

다만 연결되는 스크립트가 많아지면 먹통 되는 경우가 있음.

> ### 언제 인스펙터에 넣어 쓰고, 언제 코드로 사용하는지.
고정적으로 인스펙터에서 안 바뀔때는 public 으로 인스펙터에서 연결 하고, 자주 바뀔때는 코드로 해주자.

다만 코드로 연결시 Find, GetComponent 는 GC가 많이 발생하기 때문에, 주의할것,

> ### 오브젝트 풀 활용.
풀링 을 쉽게 쓸려면 상속이나, Interface 개념을 사용 하면 좋을것. 

자기 게임 특성에 맞게 풀링사이즈 조절. 오브젝트 풀 튜닝
오브젝트 사용 주기 따라서. 안쓰면 삭제 해주는게.
바로 끄기 보다는 언제 호출되고, 언제 꺼지는지와 같은 데이터 를 남겨서  풀링한 오브젝트 별로 지속시간을 체크 하여서, 안 쓰는 시간이 높으면 삭제 해주는 것처럼 최적화를 할수가 있다.'

+ 오디오소스 풀링 예제

효과음을 만들 때 다른 효과음이 나오더라도 이전 효과음이 끊기면 안 되기 때문에
방법을 찾다가 AudioSource.PlayClipAtPoint ()를 사용했는데
이 함수는 효과음을 재생하기 위해 실행될 때마다 오디오소스 컴포넌트를 가진
오브젝트를 하나 생성하고 오디오 클립의 시간만큼 대기한 뒤 파괴되는 형식입니다.
생성과 파괴 두 작업을 효과음 재생할 때마다 사용한다는 말이죠.

오디오 소스 컴포넌트를 가진 빈 오브젝트를 미리 4개를 하이어라키에 생성해두고
오브젝트와 오디오 소스 컴포넌트를 각각 배열로 넣은 다음 인스펙터에서 미리 연결해뒀습니다.
매번 오디오가 재생될 때마다 CurrentPlayer 가 1씩 증가하면서
오디오 소스들을 0번부터 4번까지 돌려가면서 사용합니다.
4번 오디오 소스를 사용했다면 다시 0으로 돌리는 식이죠.
https://m.blog.naver.com/PostView.nhn?blogId=2983934&logNo=220945260777&proxyReferer=https%3A%2F%2Fwww.google.co.kr%2F

> ### 씬 구조 설계
1. 유니티로고

2. 타이틀 - 로그인, 추가다운, 서버선택

1.1 로비 -> 플레이 -> 로비 
- 스테이지형,
(세븐나이츠, 몬스터길들이기, 도탑전기)

1.2 로비 & 플레이 
- 타이틀에서 loadlevelasync 로 각각 로비 플레이씬을 불러주고 로드가 다되면 불러주는식.
- 플레이와 육성이 동시에 되는 게임
예를 들어 방치형 게임(환생킹) 

> ### 한 씬으로 제작, 씬 나누어 제작 하는 것의 장단점

유저 경험과, 개발공정에 큰 영향을 준다.

씬마다 기능이 명확하게 나누어 져있으면, 씬 나누어 제작하는것이 협업하기도 좋음.

모든 씬을 하나로 합치면, 디바이스 별로 가용한 메모리가 다르기 때문에, 지원되는 디바이스도 적음.

> ### Spine 예제.
간단한 애니메이션 재생, 스킨 교체, 

foreach 
딕셔너리 의 경우에만.
반복문 퍼모먼스 체크.

> ### FindObjectsOfType 예제
특정 컴포넌트를 배열로 모아서 Selection 클래스를 통해 
선택해줌.




### Spine Animation
http://ko.esotericsoftware.com/

게임용 2D 스파인 애니메이션 제작
유료. 

#### 스파인 에셋을 유니티에 어떻게 사용 하는지?
https://github.com/kunana/spine-runtimes

1. zip 으로 다운.
2. Spine-Runtime 이라는 폴더안에 각종 플랫폼 별 스파인 런타임이 있음.
3. 유니티 프로젝트 폴더안에 스파인런타임 'C#, Unity,' 를 Import.
4. Unity 폴더안에 Getting Started 폴더에 예시로 된 씬을 참고
5. 위 사이트에서 스파인 애니메이션 제작시에 제공되는 기능을 보여줌.
6. (이미지 오버레이, 같은 스파인을 사용한 텍스쳐 변경 예시, 마테리얼 변경, 애니메이션에 물리엔진 등. UI제작.)

#### 스파인 애니메이션의 구성
1. 아틀라스 데이터
2. 아틀라스 이미지 파일
3. 애니메이션 및 스킨, 기타정보 저장 json

유니티에 임포트 할때에 두가지 파일 이 더 생김

4. 아틀라스 에셋
5. 스파인 데이터 에셋
6. 마테리얼 데이터
